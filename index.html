<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>


<script type="text/javascript">
//-----------各种升级价参数-----------------------------
var config = {
	folk_ad_price : 1,
	folk_speed_price : 1,
	train_count_price : 1,
	train_speed_price : 1,
	graduate_count_price : 1,
	graduate_price_price : 1
}

var tick_gold = 1;

//-----------各种等级参数-----------------------------

var folk_speed_lvl = 0;//

var graduate_price_lvl = 0;//
var graduate_count_max_lvl = 0;//

var train_speed_lvl = 0;//
var train_count_max_lvl = 0;//


//----------------------------------------
var gold = 0;
var train_count=0;
var graduate_count=0;

//----------------------------------------

// function upCSpeed (argument) {
// 	train_count=1+train_count;
// 	document.getElementById("c_speed").innerText = "Lv."+train_count;
// 	document.getElementById("cb_speed").innerHTML = "c_speed";
// 	// body...
// }
//-------------UTL---------------------------

function checkConsume(val){
	if( gold < val )return false;
	gold = gold - val;
	return true;

}

//----------------------------------------

function folkAd (argument) {
	if( checkConsume(config.folk_ad_price) )
	__folk_ad = __folk_ad+3;
	document.getElementById("f_ad").innerText = "效果:"+__folk_ad;
}

function folkSpeedLvlup (argument) {
	if( checkConsume( config.folk_speed_price*Math.pow(2,folk_speed_lvl) ) )
		folk_speed_lvl=1+folk_speed_lvl;
	
	document.getElementById("f_speed").innerHTML = "效果:"+folk_speed_lvl;
}
function trainCountMaxLvlup (argument) {
	if( checkConsume( config.train_count_price*Math.pow(2,  train_count_max_lvl) ) )
		train_count_max_lvl=1+train_count_max_lvl;
	document.getElementById("c_count").innerHTML = "Lv."+train_count_max_lvl;
}
function trainSpeedLvlup (argument) {
	if( checkConsume( 
		config.train_speed_price*Math.pow(2, train_speed_lvl) ) )
		train_speed_lvl=1+train_speed_lvl;
	document.getElementById("c_speed").innerHTML = "Lv."+train_speed_lvl;
}

function graduateSell (argument) {
	if( graduate_count < 1 )return;
	gold = gold+graduate_count * graduateGetPrice();
	graduate_count = 0;
}
function graduatePriceLvlup (argument) {
	if( checkConsume( 
		config.graduate_count_price*Math.pow(2, graduate_price_lvl) ) )
		graduate_price_lvl=1+graduate_price_lvl;
	document.getElementById("g_price").innerHTML = "Lv."+graduate_price_lvl;
	document.getElementById("l_graduate_price").innerText = "学生价格:￥"+graduateGetPrice();

}
function graduateCountLvlup (argument) {
	if( checkConsume( 
		config.graduate_price_price*Math.pow(2, graduate_count_max_lvl) ) )
		graduate_count_max_lvl=1+graduate_count_max_lvl;
	document.getElementById("g_count").innerHTML = "Lv."+graduate_count_max_lvl;
}





//======================================
//---------------处理逻辑-----------------
//======================================




var __folk_tick = 0;
var __folk_ad = 0;

function folkGetSpeed () {
	return folk_speed_lvl+1
}

function folkUpdate(){
	
	__folk_tick = __folk_tick + __folk_ad +  folkGetSpeed();

	if (__folk_ad>0) {
		--__folk_ad;
		document.getElementById("f_ad").innerText = "效果:"+__folk_ad;
	}
	if( __folk_tick > 25 ){

		var count_new = parseInt(__folk_tick / 25);
		__folk_tick = 0;
		return count_new;
	}
	return 0;
}


//----------------------------------------





var __train_tick = 0;

function trainGetSpeed () {
	return train_speed_lvl
}
function trainGetMax () {
	return train_count_max_lvl + 10
}

function trainAddUnit(val){
	var max_count = trainGetMax();

	train_count = train_count + val;

	if( train_count > max_count ){
		train_count = max_count;
		//todo log 
	}
}

function trainUpdate (argument) {
	// body...
	if( train_count < 1 ) return 0;
	__train_tick = __train_tick + trainGetSpeed() + 1;

	if( __train_tick > 25 ){
		var count_new = parseInt(__train_tick / 25);
		__train_tick = 0;
		train_count = train_count - count_new;
		return count_new;
	}

	if(Math.random()<0.05){
		--train_count;
		//todo Log
		return 0;
	}
	if( Math.random()<0.05 ){
		gold = gold + parseInt(Math.random()*100);
		//todo log
		return 0;
	}
	return 0
}



//----------------------------------------




var __graduate_tick = 0;

function graduateGetCountMax (argument) {
	return graduate_count_max_lvl + 10;
}

function graduateGetPrice (argument) {
	return 100 + graduate_price_lvl * 20
}

function graduateAddUnit (val) {
	graduate_count=val+graduate_count;
}

function graduateUpdate(){
	if( graduate_count > graduateGetCountMax() ){
		if( Math.random() < 0.5 ){
			//todo log
			--graduate_count;
		}
	}


}

function updateLogic (argument) {
	var new_folk = folkUpdate();
	if( new_folk > 0 ){
		trainAddUnit(new_folk)
	}
	var new_graduate = trainUpdate();
	if( new_graduate > 0 ){
		graduateAddUnit(new_graduate)
	}
	graduateUpdate();
	gold = gold + tick_gold;
	document.getElementById("l_gold").innerText = "资金：￥"+gold;
	document.getElementById("l_train").innerText = "培训中："+train_count+"/"+trainGetMax()+"人";
	document.getElementById("l_graduate").innerText = "待业："+graduate_count+"/"+graduateGetCountMax()+"人";
	
}

</script>



<body onLoad="setInterval('updateLogic()',100);">
	<div>
		<div>
			<div>
				<label id="l_gold" text="0000" y="30">资金</label>
			</div>
			<div>
				<label id="l_train" text="0000" y="30">培训</label>
			</div>
			<div>
				<label id="l_graduate" text="0000" y="30">毕业</label>
				<button id="gb_sell" onclick="graduateSell();" style="width:85px;height:20px;">出售</button>

			</div>
			<div>
				<label id="l_graduate_price" text="0000" y="30">学生价格:￥100</label>
			</div>
			<div>
				<label id="f_ad" text="0000" y="30">Lv.0</label>
				<button id="fb_ad" onclick="folkAd();" style="width:85px;height:20px;">发小广告￥10</button>
			</div>

			<div>
				<label id="f_speed" text="0000" y="30">Lv.0</label>
				<button id="fb_speed" onclick="folkSpeedLvlup();" style="width:85px;height:20px;">招生速度</button>
			</div>

			<div>
				<label id="c_speed" text="0000" y="30">Lv.0</label>
				<button id="cb_speed" onclick="trainSpeedLvlup();" style="width:85px;height:20px;">培训速度</button>
			</div>
			<div>
				<label id="c_count" text="0000" y="30">Lv.0</label>
				<button id="cb_count" onclick="trainCountMaxLvlup();" style="width:85px;height:20px;">学院规模</button>
			</div>


			<div>
				<label id="g_price" text="0000" y="30">Lv.0</label>
				<button id="gb_price" onclick="graduatePriceLvlup();" style="width:85px;height:20px;">钻研挖掘技术</button>
			</div>
			<div>
				<label id="g_count" text="0000" y="30">Lv.0</label>
				<button id="gb_count" onclick="graduateCountLvlup();" style="width:85px;height:20px;">就业率</button>
			</div>
		</div>
		
		
	</div>
</body>
